# 要件定義書 (Requirement Definition)

## 1. プロジェクト概要
**プロジェクト名:** Base Occupy  
**プラットフォーム:** Base Network (L2), Farcaster Frame v2  
**概要:** Baseチェーン上の「王座」を少額のETHで奪い合う陣取りオークションゲーム。最後に王座に座っていたプレイヤーが賞金を総取りする。

## 2. 目的・ゴール
- Baseネットワークの特性（低コスト、高速）を活かしたオンチェーンゲームの提供。
- Farcaster Frame v2を活用し、SNS（Warpcast）から直接参加できるシームレスな体験の提供。
- ユーザー間の競争とNFTの進化を通じたエンゲージメントの最大化。

## 3. 機能要件

### 3.1 ゲームロジック (スマートコントラクト)
- **王座の奪い合い:** 参加費 (0.01 ETH) を支払うことで王座を獲得（Occupy）できる。
- **賞金プール:** 参加費の90%が賞金プール、10%が管理者手数料として蓄積される。
- **時間制限:** 
  - Occupyするたびに終了時刻（deadline）が延長される。
  - 基本延長時間: 10分。
  - サドンデスモード時は短縮（例: 1分）。
- **勝利条件:** deadlineを過ぎた時点で最後に王座に座っていたプレイヤー（Last Depositor）が勝者。
- **報酬受け取り:** 勝者のみが賞金プールを引き出し可能。
- **サドンデスモード:** 管理者がトリガーすることで延長時間を短縮し、ゲーム終了を促進する機能。

### 3.2 NFT・メタデータ
- **会員証NFT:** 初回参加時にSoulbound的（あるいは譲渡可能、要件では1人1枚とあるが譲渡制限の明記なし、一旦標準ERC721想定で1人1枚制限を実装）なNFTを発行。
- **動的画像 (On-chain SVG):** プレイヤーの状態に応じて画像が変化。
  - **Eternal King:** 過去に優勝したことがある（永遠の王者）。
  - **Current King:** 現在の王座保持者。
  - **Veteran:** 参加回数10回以上。
  - **Challenger:** 初心者。

### 3.3 フロントエンド (Web & Frame)
- **Webアプリ (Next.js):**
  - 現在の王座保持者、賞金プール、残り時間のリアルタイム表示。
  - 参加ボタン（Occupy）。
  - ユーザー自身のステータス（ランク、進化までの回数）表示。
  - 過去の勝者リスト。
  - **メニュー機能:** ゲーム説明、設定などを格納するメニュー。
  - **多言語対応:** 日本語と英語の切り替え機能。
  - **UX改善:** Base Sepoliaテストネット利用であることの明示、王座獲得時の特典（シェア機能）の説明による動機付け。
- **Farcaster Frame v2:**
  - アプリを開かずに王座状況を確認可能。
  - ワンタップでOccupy（署名・トランザクション）実行。
  - シェア機能（現在の賞金額等を投稿）。

## 4. 非機能要件
- **セキュリティ:** ReentrancyGuardの使用、Pull型決済（Claim方式）、アクセス制御。
- **ユーザビリティ:** ウォレット接続の簡易化、トランザクションフィードバック。
- **拡張性:** 将来的なパラメータ調整（管理機能）。

## 5. 運用要件
- 管理者による手数料引き出し。
- サドンデスの発動運用。
